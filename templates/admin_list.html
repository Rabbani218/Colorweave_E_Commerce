{% extends "base.html" %}

{% block title %}Admin - Products{% endblock %}

{% block content %}
<div class="container" style="margin-top:80px;">
  <h2>Products Admin</h2>
  <a href="{{ url_for('admin.logout') }}" class="btn">Logout</a>
  <h3>Add New Product</h3>
  <form method="POST" action="{{ url_for('admin.add') }}" enctype="multipart/form-data">
    <input name="name" placeholder="Name" required>
    <input name="price" placeholder="Price" type="number" required>
    <input name="stock" placeholder="Stock" type="number" value="10" required>
    <input name="image_file" type="file" accept="image/*">
    <small>If no file uploaded, you can enter an existing image filename in the edit form after adding.</small>
    <textarea name="description" placeholder="Description"></textarea>
    <button class="btn btn-buy" type="submit">Add product</button>
  </form>
  <h3>Import / Export</h3>
  <form method="POST" action="{{ url_for('admin.import_products') }}" enctype="multipart/form-data">
    <input type="file" name="import_file" accept="application/json">
    <button class="btn" type="submit">Import JSON</button>
  </form>
  <a href="{{ url_for('admin.export') }}" class="btn">Export JSON</a>

  <h3>Existing Products</h3>
  <table class="cart-table">
    <thead><tr><th>ID</th><th>Name</th><th>Price</th><th>Stock</th><th>Actions</th></tr></thead>
    <tbody>
      {% for p in products %}
      <tr>
        <td>{{ p.id }}</td>
        <td>{{ p.name }}</td>
        <td>{{ p.price }}</td>
        <td>{{ p.stock }}</td>
        <td>
          <a href="{{ url_for('admin.edit', product_id=p.id) }}" class="btn">Edit</a>
          <a href="{{ url_for('admin.delete', product_id=p.id) }}" class="btn btn-dark">Delete</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
